import React, { useState } from 'react';
import { useQuery } from 'react-query';
import axios from 'axios';
import {
  BuildingStorefrontIcon,
  ChartBarIcon,
  DocumentCheckIcon,
  Cog6ToothIcon,
  ClipboardDocumentCheckIcon,
  DocumentArrowDownIcon,
  CurrencyEuroIcon,
  ArrowTrendingUpIcon,
  ShieldCheckIcon,
  ClockIcon,
  ExclamationTriangleIcon
} from '@heroicons/react/24/outline';
import LoadingSpinner from '../../components/UI/LoadingSpinner';

const ChainManagement = () => {
  const [activeTab, setActiveTab] = useState('overview');
  const [showDetailModal, setShowDetailModal] = useState(false);
  const [modalContent, setModalContent] = useState({ title: '', content: '', type: '' });

  const { data: chainData, isLoading } = useQuery(
    'chainData',
    () => axios.get('/api/chains/dashboard').then(res => res.data)
  );

  const showModal = (title, content, type = 'info') => {
    setModalContent({ title, content, type });
    setShowDetailModal(true);
  };



  if (isLoading) {
    return (
      <div className="flex justify-center items-center h-64">
        <LoadingSpinner size="lg" />
      </div>
    );
  }

  const tabs = [
    { id: 'overview', name: 'Vue d\'ensemble', icon: ChartBarIcon },
    { id: 'sites', name: 'Gestion Sites', icon: BuildingStorefrontIcon },
    { id: 'standards', name: 'Standards', icon: DocumentCheckIcon },
    { id: 'audits', name: 'Audits', icon: Cog6ToothIcon },
  ];

  return (
    <div className="space-y-6">
      {/* Header */}
      <div>
        <h1 className="text-2xl font-bold text-gray-900">Gestion Cha√Æne</h1>
        <p className="text-gray-600">
          Pilotage multi-sites et standardisation
        </p>
      </div>

      {/* Tabs */}
      <div className="border-b border-gray-200">
        <nav className="-mb-px flex space-x-8">
          {tabs.map((tab) => (
            <button
              key={tab.id}
              onClick={() => setActiveTab(tab.id)}
              className={`py-2 px-1 border-b-2 font-medium text-sm flex items-center space-x-2 ${
                activeTab === tab.id
                  ? 'border-primary-500 text-primary-600'
                  : 'border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300'
              }`}
            >
              <tab.icon className="h-5 w-5" />
              <span>{tab.name}</span>
            </button>
          ))}
        </nav>
      </div>

      {/* Tab Content */}
      <div className="mt-6">
        {activeTab === 'overview' && <ChainOverview data={chainData} showModal={showModal} />}
        {activeTab === 'sites' && <SitesManagement data={chainData?.sites} showModal={showModal} />}
        {activeTab === 'standards' && <StandardsManagement showModal={showModal} />}
        {activeTab === 'audits' && <AuditsManagement showModal={showModal} />}
      </div>

      {/* Detail Modal */}
      {showDetailModal && (
        <div className="fixed inset-0 z-50 overflow-y-auto">
          <div className="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div className="fixed inset-0 transition-opacity" onClick={() => setShowDetailModal(false)}>
              <div className="absolute inset-0 bg-gray-500 opacity-75"></div>
            </div>

            <div className="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full">
              <div className="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                <div className="flex items-start">
                  <div className={`mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full ${
                    modalContent.type === 'success' ? 'bg-green-100' :
                    modalContent.type === 'warning' ? 'bg-yellow-100' :
                    modalContent.type === 'error' ? 'bg-red-100' : 'bg-blue-100'
                  } sm:mx-0 sm:h-10 sm:w-10`}>
                    {modalContent.type === 'success' && (
                      <svg className="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M5 13l4 4L19 7" />
                      </svg>
                    )}
                    {modalContent.type === 'warning' && (
                      <svg className="h-6 w-6 text-yellow-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z" />
                      </svg>
                    )}
                    {(modalContent.type === 'info' || !modalContent.type) && (
                      <svg className="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path strokeLinecap="round" strokeLinejoin="round" strokeWidth={2} d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                      </svg>
                    )}
                  </div>
                  <div className="mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left flex-1">
                    <h3 className="text-lg leading-6 font-medium text-gray-900 mb-4">
                      {modalContent.title}
                    </h3>
                    <div className="mt-2">
                      <div className="text-sm text-gray-500">
                        {typeof modalContent.content === 'string' ? (
                          <div className="whitespace-pre-line">{modalContent.content}</div>
                        ) : (
                          modalContent.content
                        )}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div className="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                <button
                  type="button"
                  onClick={() => setShowDetailModal(false)}
                  className="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm"
                >
                  Fermer
                </button>
              </div>
            </div>
          </div>
        </div>
      )}
    </div>
  );
};

const ChainOverview = ({ data, showModal }) => {
  const sites = data?.sites || [];
  const performance = data?.performance || {};

  return (
    <div className="space-y-6">


      {/* KPIs Graphiques Interactifs */}
      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6">
        
        {/* Sites Total - Graphique en barres */}
        <div className="bg-gradient-to-br from-blue-50 to-indigo-100 rounded-2xl p-6 shadow-xl border border-blue-200 hover:shadow-2xl transition-all duration-300 cursor-pointer transform hover:scale-105" 
             onClick={() => showModal('D√©tail des Sites', 
               `üìä ANALYSE D√âTAILL√âE DES SITES\n\n` +
               `üè™ Nombre total de sites: ${sites.length}\n\n` +
               `üìç Performance par r√©gion:\n` +
               `   üü¢ Paris: Excellent (92%)\n` +
               `   üîµ Lyon: Tr√®s bon (88%)\n` +
               `   üü° Toulouse: Bon (85%)\n` +
               `   üü† Nice: Bon (82%)\n` +
               `   üî¥ Marseille: √Ä am√©liorer (78%)\n\n` +
               `üìà √âvolution (3 derniers mois):\n` +
               `   ‚Ä¢ Octobre: 80%\n` +
               `   ‚Ä¢ Novembre: 83%\n` +
               `   ‚Ä¢ D√©cembre: 85% (+2%)\n\n` +
               `üéØ Actions prioritaires:\n` +
               `   üî¥ Formation √©quipe Marseille (Urgent)\n` +
               `   üü° Optimisation Nice/Toulouse\n` +
               `   üü¢ Maintenir standards Paris/Lyon\n\n` +
               `üìä Objectifs 2025:\n` +
               `   ‚Ä¢ Atteindre 90% sur tous les sites\n` +
               `   ‚Ä¢ Ouvrir 2 nouveaux sites\n` +
               `   ‚Ä¢ Certification qualit√© ISO`, 'info')}>
          <div className="flex items-center justify-between mb-4">
            <div className="p-3 bg-blue-500 rounded-xl shadow-lg">
              <BuildingStorefrontIcon className="h-8 w-8 text-white" />
            </div>
            <div className="text-right">
              <div className="text-xs text-blue-600 font-medium">+2 ce mois</div>
              <div className="w-2 h-2 bg-green-400 rounded-full animate-pulse"></div>
            </div>
          </div>
          
          <h3 className="text-lg font-semibold text-blue-900 mb-2">Sites Total</h3>
          <div className="flex items-end space-x-1 mb-3 h-12">
            {[92, 88, 85, 82, 78].map((height, index) => (
              <div key={index} className="flex-1 bg-gradient-to-t from-blue-400 to-blue-600 rounded-t-lg opacity-80 hover:opacity-100 transition-opacity" 
                   style={{ height: `${height}%` }}></div>
            ))}
          </div>
          <div className="flex items-baseline justify-between">
            <span className="text-4xl font-bold text-blue-700">{sites.length}</span>
            <div className="text-sm text-blue-600">
              <span className="inline-flex items-center px-2 py-1 rounded-full bg-green-100 text-green-800">
                <ArrowTrendingUpIcon className="h-3 w-3 mr-1" />
                +12%
              </span>
            </div>
          </div>
        </div>

        {/* CA Total - Graphique en aires */}
        <div className="bg-gradient-to-br from-green-50 to-emerald-100 rounded-2xl p-6 shadow-xl border border-green-200 hover:shadow-2xl transition-all duration-300 cursor-pointer transform hover:scale-105"
             onClick={() => showModal('Analyse Chiffre d\'Affaires', 
               `üí∞ ANALYSE FINANCI√àRE D√âTAILL√âE\n\n` +
               `üìä CA Total Mensuel: ${(performance.totalRevenue || 125000).toLocaleString()}‚Ç¨\n` +
               `üìà √âvolution: +12% vs mois pr√©c√©dent\n` +
               `üéØ Objectif mensuel: 130,000‚Ç¨ (96% atteint)\n\n` +
               `üíµ R√©partition par site:\n` +
               `   üü¢ Paris Centre: 75,000‚Ç¨ (60%)\n` +
               `   üîµ Lyon Part-Dieu: 54,000‚Ç¨ (43%)\n` +
               `   üü° Toulouse Centre: 45,000‚Ç¨ (36%)\n` +
               `   üü† Marseille V.Port: 36,000‚Ç¨ (29%)\n` +
               `   üî¥ Nice Promenade: 33,000‚Ç¨ (26%)\n\n` +
               `üìà Pr√©visions trimestrielles:\n` +
               `   ‚Ä¢ Janvier: +8% (135,000‚Ç¨)\n` +
               `   ‚Ä¢ F√©vrier: +5% (142,000‚Ç¨)\n` +
               `   ‚Ä¢ Mars: +3% (146,000‚Ç¨)\n\n` +
               `üéØ Actions recommand√©es:\n` +
               `   ‚Ä¢ Campagne marketing Marseille\n` +
               `   ‚Ä¢ Optimisation menu Nice\n` +
               `   ‚Ä¢ Formation vente Toulouse\n` +
               `   ‚Ä¢ Maintenir excellence Paris/Lyon`, 'success')}>
          <div className="flex items-center justify-between mb-4">
            <div className="p-3 bg-green-500 rounded-xl shadow-lg">
              <CurrencyEuroIcon className="h-8 w-8 text-white" />
            </div>
            <div className="text-right">
              <div className="text-xs text-green-600 font-medium">Objectif: 96%</div>
              <div className="w-16 bg-green-200 rounded-full h-2">
                <div className="w-full h-2 bg-gradient-to-r from-green-400 to-green-600 rounded-full"></div>
              </div>
            </div>
          </div>
          
          <h3 className="text-lg font-semibold text-green-900 mb-2">CA Total</h3>
          <div className="relative h-12 mb-3">
            <svg className="w-full h-full" viewBox="0 0 100 40">
              <defs>
                <linearGradient id="revenueGradient" x1="0%" y1="0%" x2="0%" y2="100%">
                  <stop offset="0%" stopColor="#10b981" stopOpacity="0.8"/>
                  <stop offset="100%" stopColor="#10b981" stopOpacity="0.1"/>
                </linearGradient>
              </defs>
              <path d="M0,35 Q25,25 50,20 T100,15 L100,40 L0,40 Z" fill="url(#revenueGradient)" />
              <path d="M0,35 Q25,25 50,20 T100,15" stroke="#10b981" strokeWidth="2" fill="none" />
              <circle cx="100" cy="15" r="3" fill="#059669" />
            </svg>
          </div>
          <div className="flex items-baseline justify-between">
            <span className="text-4xl font-bold text-green-700">{(performance.totalRevenue || 0).toLocaleString()}‚Ç¨</span>
            <div className="text-sm text-green-600">
              <span className="inline-flex items-center px-2 py-1 rounded-full bg-green-100 text-green-800">
                <ArrowTrendingUpIcon className="h-3 w-3 mr-1" />
                +12%
              </span>
            </div>
          </div>
        </div>

        {/* Score Moyen - Graphique circulaire */}
        <div className="bg-gradient-to-br from-orange-50 to-amber-100 rounded-2xl p-6 shadow-xl border border-orange-200 hover:shadow-2xl transition-all duration-300 cursor-pointer transform hover:scale-105"
             onClick={() => showModal('Score de Performance', 
               `‚≠ê √âVALUATION PERFORMANCE GLOBALE\n\n` +
               `üìä Score Moyen Cha√Æne: ${performance.avgScore || 85}%\n` +
               `üéØ Objectif: 90% (√âcart: -5%)\n\n` +
               `üìã Crit√®res d'√©valuation:\n` +
               `   üü¢ Propret√©/Hygi√®ne: 95%\n` +
               `   üü¢ Qualit√© produits: 92%\n` +
               `   üü° Service client: 88%\n` +
               `   üü† Pr√©sentation: 85%\n` +
               `   üî¥ Temps d'attente: 78%\n\n` +
               `üìà √âvolution (3 derniers mois):\n` +
               `   ‚Ä¢ Octobre: 82%\n` +
               `   ‚Ä¢ Novembre: 84%\n` +
               `   ‚Ä¢ D√©cembre: 85% (+1%)\n\n` +
               `üéØ Plan d'am√©lioration:\n` +
               `   ‚Ä¢ Formation service (Temps d'attente)\n` +
               `   ‚Ä¢ Standards pr√©sentation\n` +
               `   ‚Ä¢ Audit qualit√© mensuel\n` +
               `   ‚Ä¢ Syst√®me de r√©compenses √©quipes\n\n` +
               `üìä Objectifs 2025:\n` +
               `   ‚Ä¢ Atteindre 90% global\n` +
               `   ‚Ä¢ 95% sur temps d'attente\n` +
               `   ‚Ä¢ Certification service client`, 'warning')}>
          <div className="flex items-center justify-between mb-4">
            <div className="p-3 bg-orange-500 rounded-xl shadow-lg">
              <ChartBarIcon className="h-8 w-8 text-white" />
            </div>
            <div className="text-right">
              <div className="text-xs text-orange-600 font-medium">Objectif: 90%</div>
              <div className="flex space-x-1">
                {[1,2,3,4].map((star, index) => (
                  <div key={index} className={`w-2 h-2 rounded-full ${index < 3 ? 'bg-orange-400' : 'bg-orange-200'}`}></div>
                ))}
              </div>
            </div>
          </div>
          
          <h3 className="text-lg font-semibold text-orange-900 mb-2">Score Moyen</h3>
          <div className="flex items-center justify-center mb-3">
            <div className="relative w-20 h-20">
              <svg className="w-20 h-20 transform -rotate-90" viewBox="0 0 100 100">
                <circle cx="50" cy="50" r="40" stroke="#fed7aa" strokeWidth="8" fill="transparent" />
                <circle cx="50" cy="50" r="40" stroke="#f97316" strokeWidth="8" fill="transparent"
                        strokeDasharray={`${2 * Math.PI * 40}`}
                        strokeDashoffset={`${2 * Math.PI * 40 * (1 - (performance.avgScore || 0) / 100)}`}
                        strokeLinecap="round"
                        className="transition-all duration-1000 ease-out" />
              </svg>
              <div className="absolute inset-0 flex items-center justify-center">
                <span className="text-lg font-bold text-orange-700">{performance.avgScore || 0}%</span>
              </div>
            </div>
          </div>
          <div className="text-center">
            <span className="inline-flex items-center px-2 py-1 rounded-full bg-yellow-100 text-yellow-800 text-sm">
              <ClockIcon className="h-3 w-3 mr-1" />
              +1% ce mois
            </span>
          </div>
        </div>

        {/* Conformit√© - Graphique en jauge */}
        <div className="bg-gradient-to-br from-purple-50 to-violet-100 rounded-2xl p-6 shadow-xl border border-purple-200 hover:shadow-2xl transition-all duration-300 cursor-pointer transform hover:scale-105"
             onClick={() => showModal('Conformit√© Standards', 
               `‚úÖ AUDIT DE CONFORMIT√â\n\n` +
               `üìä Taux de Conformit√©: ${performance.compliance || 95}%\n` +
               `üéØ Objectif: 98% (√âcart: -3%)\n` +
               `‚ùå Non-conformit√©s actives: 3\n\n` +
               `üìã Derniers audits (D√©cembre):\n` +
               `   ‚úÖ Paris Centre: 98% (Conforme)\n` +
               `   ‚úÖ Lyon Part-Dieu: 96% (Conforme)\n` +
               `   ‚ö†Ô∏è Toulouse Centre: 94% (Attention)\n` +
               `   ‚ö†Ô∏è Nice Promenade: 92% (Attention)\n` +
               `   ‚ùå Marseille V.Port: 88% (Non-conforme)\n\n` +
               `‚ùå Non-conformit√©s identifi√©es:\n` +
               `   üî¥ Proc√©dure fermeture (2 sites) - Priorit√© Haute\n` +
               `   üü° Stock rotation (1 site) - Priorit√© Moyenne\n` +
               `   üü† Formation √©quipe (1 site) - Priorit√© Moyenne\n\n` +
               `üîß Actions correctives planifi√©es:\n` +
               `   ‚Ä¢ Audit surprise Marseille (15 Jan)\n` +
               `   ‚Ä¢ Formation proc√©dures (20 Jan)\n` +
               `   ‚Ä¢ Mise √† jour check-lists (25 Jan)\n` +
               `   ‚Ä¢ Suivi hebdomadaire (Continu)\n\n` +
               `üìà Objectifs 2025:\n` +
               `   ‚Ä¢ Atteindre 98% de conformit√©\n` +
               `   ‚Ä¢ Z√©ro non-conformit√© critique\n` +
               `   ‚Ä¢ Certification ISO 22000`, 'info')}
                     </div>
                     <div className="bg-white p-3 rounded-lg shadow-sm">
                       <div className="text-2xl font-bold text-red-600">3</div>
                       <div className="text-sm text-gray-600">Non-conformit√©s</div>
                     </div>
                   </div>
                   
                   <div className="space-y-3">
                     {[
                       { site: 'Paris Centre', score: 98, status: '‚úÖ', color: 'bg-green-500' },
                       { site: 'Lyon Part-Dieu', score: 96, status: '‚úÖ', color: 'bg-green-400' },
                       { site: 'Toulouse Centre', score: 94, status: '‚ö†Ô∏è', color: 'bg-yellow-500' },
                       { site: 'Nice Promenade', score: 92, status: '‚ö†Ô∏è', color: 'bg-orange-500' },
                       { site: 'Marseille V.Port', score: 88, status: '‚ùå', color: 'bg-red-500' }
                     ].map((site, index) => (
                       <div key={index} className="flex items-center space-x-3">
                         <div className="w-2 text-lg">{site.status}</div>
                         <div className="w-28 text-sm">{site.site}</div>
                         <div className="flex-1 bg-gray-200 rounded-full h-3">
                           <div className={`h-3 rounded-full ${site.color}`} style={{ width: `${site.score}%` }}></div>
                         </div>
                         <div className="w-12 text-right text-sm font-semibold">{site.score}%</div>
                       </div>
                     ))}
                   </div>
                 </div>
                 
                 <div className="bg-gradient-to-r from-red-50 to-pink-50 p-4 rounded-lg">
                   <h4 className="font-semibold text-red-900 mb-3">‚ùå Points d'Am√©lioration</h4>
                   <div className="space-y-2">
                     {[
                       { probleme: 'Proc√©dure fermeture', sites: 2, priorite: 'Haute' },
                       { probleme: 'Rotation des stocks', sites: 1, priorite: 'Moyenne' },
                       { probleme: 'Formation √©quipe', sites: 1, priorite: 'Haute' }
                     ].map((item, index) => (
                       <div key={index} className="flex items-center justify-between p-2 bg-white rounded-lg">
                         <div className="flex items-center space-x-3">
                           <div className={`w-2 h-2 rounded-full ${item.priorite === 'Haute' ? 'bg-red-500' : 'bg-yellow-500'}`}></div>
                           <span className="text-sm font-medium">{item.probleme}</span>
                         </div>
                         <div className="text-xs text-gray-600">{item.sites} site(s)</div>
                       </div>
                     ))}
                   </div>
                 </div>
                 
                 <div className="bg-gradient-to-r from-green-50 to-emerald-50 p-4 rounded-lg">
                   <h4 className="font-semibold text-green-900 mb-3">üîß Plan d'Action</h4>
                   <div className="space-y-2">
                     <div className="flex items-center space-x-2">
                       <div className="w-2 h-2 bg-red-500 rounded-full"></div>
                       <span className="text-sm">Audit surprise Marseille (15 Jan)</span>
                     </div>
                     <div className="flex items-center space-x-2">
                       <div className="w-2 h-2 bg-yellow-500 rounded-full"></div>
                       <span className="text-sm">Formation proc√©dures (20 Jan)</span>
                     </div>
                     <div className="flex items-center space-x-2">
                       <div className="w-2 h-2 bg-blue-500 rounded-full"></div>
                       <span className="text-sm">Mise √† jour check-lists</span>
                     </div>
                   </div>
                 </div>
               `üìà Objectifs 2025:\n` +
               `   ‚Ä¢ Atteindre 98% de conformit√©\n` +
               `   ‚Ä¢ Z√©ro non-conformit√© critique\n` +
               `   ‚Ä¢ Certification ISO 22000`, 'info')}>
          <div className="flex items-center justify-between mb-4">
            <div className="p-3 bg-purple-500 rounded-xl shadow-lg">
              <ShieldCheckIcon className="h-8 w-8 text-white" />
            </div>
            <div className="text-right">
              <div className="text-xs text-purple-600 font-medium">3 actions</div>
              <div className="flex space-x-1">
                <div className="w-2 h-2 bg-red-400 rounded-full animate-pulse"></div>
                <div className="w-2 h-2 bg-yellow-400 rounded-full"></div>
                <div className="w-2 h-2 bg-green-400 rounded-full"></div>
              </div>
            </div>
          </div>
          
          <h3 className="text-lg font-semibold text-purple-900 mb-2">Conformit√©</h3>
          <div className="relative mb-3">
            <div className="w-full bg-purple-200 rounded-full h-4">
              <div className="bg-gradient-to-r from-purple-400 to-purple-600 h-4 rounded-full transition-all duration-1000 ease-out relative overflow-hidden"
                   style={{ width: `${performance.compliance || 95}%` }}>
                <div className="absolute inset-0 bg-gradient-to-r from-transparent via-white to-transparent opacity-30 animate-pulse"></div>
              </div>
            </div>
            <div className="flex justify-between text-xs text-purple-600 mt-1">
              <span>0%</span>
              <span>50%</span>
              <span>100%</span>
            </div>
          </div>
          <div className="flex items-baseline justify-between">
            <span className="text-4xl font-bold text-purple-700">{performance.compliance || 95}%</span>
            <div className="text-sm text-purple-600">
              <span className="inline-flex items-center px-2 py-1 rounded-full bg-purple-100 text-purple-800">
                <ExclamationTriangleIcon className="h-3 w-3 mr-1" />
                -3% obj.
              </span>
            </div>
          </div>
        </div>
      </div>

      {/* Sites Performance - Tableau Interactif */}
      <div className="card">
        <div className="flex justify-between items-center mb-4">
          <h3 className="text-lg font-medium text-gray-900">Performance par site</h3>
        </div>
        <div className="overflow-x-auto">
          <table className="min-w-full divide-y divide-gray-200">
            <thead className="bg-gray-50">
              <tr>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Site
                </th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  CA Jour
                </th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Score
                </th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Statut
                </th>
                <th className="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">
                  Actions
                </th>
              </tr>
            </thead>
            <tbody className="bg-white divide-y divide-gray-200">
              {sites.map((site) => (
                <tr key={site.id} className="hover:bg-gray-50 transition-colors">
                  <td className="px-6 py-4 whitespace-nowrap">
                    <div className="text-sm font-medium text-gray-900">{site.name}</div>
                    <div className="text-sm text-gray-500">{site.location}</div>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap text-sm text-gray-900">
                    {site.dailyRevenue || 0}‚Ç¨
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <div className="flex items-center">
                      <div className="text-sm font-medium text-gray-900">{site.score || 0}%</div>
                      <div className={`ml-2 w-16 bg-gray-200 rounded-full h-2`}>
                        <div 
                          className={`h-2 rounded-full ${
                            (site.score || 0) >= 80 ? 'bg-green-500' : 
                            (site.score || 0) >= 60 ? 'bg-yellow-500' : 'bg-red-500'
                          }`}
                          style={{ width: `${site.score || 0}%` }}
                        ></div>
                      </div>
                    </div>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap">
                    <span className={`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${
                      site.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
                    }`}>
                      {site.status === 'active' ? 'Actif' : 'Inactif'}
                    </span>
                  </td>
                  <td className="px-6 py-4 whitespace-nowrap text-sm font-medium">
                    <button 
                      className="text-blue-600 hover:text-blue-900 mr-3"
                      onClick={() => showModal(`Gestion ${site.name}`, 
                        `üè™ PANNEAU DE GESTION - ${site.name}\n\n` +
                        `üìä Informations g√©n√©rales:\n` +
                        `   ‚Ä¢ Manager: ${site.manager}\n` +
                        `   ‚Ä¢ Adresse: ${site.location}\n` +
                        `   ‚Ä¢ Statut: ${site.status === 'active' ? 'Actif' : 'Inactif'}\n` +
                        `   ‚Ä¢ Score actuel: ${site.score}%\n\n` +
                        `üí∞ Performance financi√®re:\n` +
                        `   ‚Ä¢ CA aujourd'hui: ${site.dailyRevenue}‚Ç¨\n` +
                        `   ‚Ä¢ CA mensuel estim√©: ${(site.dailyRevenue * 30).toLocaleString()}‚Ç¨\n` +
                        `   ‚Ä¢ Objectif mensuel: ${Math.round(site.dailyRevenue * 35).toLocaleString()}‚Ç¨\n\n` +
                        `üë• √âquipe (${Math.floor(Math.random() * 8) + 12} employ√©s):\n` +
                        `   ‚Ä¢ Manager: ${site.manager}\n` +
                        `   ‚Ä¢ Chefs: ${Math.floor(Math.random() * 3) + 2}\n` +
                        `   ‚Ä¢ Serveurs: ${Math.floor(Math.random() * 4) + 4}\n` +
                        `   ‚Ä¢ Personnel cuisine: ${Math.floor(Math.random() * 3) + 3}\n\n` +
                        `üéØ Actions disponibles:\n` +
                        `   ‚Ä¢ Modifier les param√®tres du site\n` +
                        `   ‚Ä¢ Planifier un audit qualit√©\n` +
                        `   ‚Ä¢ G√©rer les horaires √©quipe\n` +
                        `   ‚Ä¢ Voir rapports d√©taill√©s\n` +
                        `   ‚Ä¢ Configurer les standards`, 'info')}
                    >
                      G√©rer
                    </button>
                    <button 
                      className="text-green-600 hover:text-green-900 mr-3"
                      onClick={() => showModal(`Rapport ${site.name}`, 
                        `üìä RAPPORT D√âTAILL√â - ${site.name}\n\n` +
                        `üí∞ Performance financi√®re:\n` +
                        `   ‚Ä¢ CA aujourd'hui: ${site.dailyRevenue}‚Ç¨\n` +
                        `   ‚Ä¢ CA mensuel: ${(site.dailyRevenue * 30).toLocaleString()}‚Ç¨\n` +
                        `   ‚Ä¢ √âvolution: +${Math.floor(Math.random() * 20) + 5}%\n` +
                        `   ‚Ä¢ Objectifs atteints: ${Math.floor(Math.random() * 30) + 70}%\n\n` +
                        `üìà Tendances (7 derniers jours):\n` +
                        `   ‚Ä¢ Lundi: ${Math.round(site.dailyRevenue * 0.8)}‚Ç¨\n` +
                        `   ‚Ä¢ Mardi: ${Math.round(site.dailyRevenue * 0.9)}‚Ç¨\n` +
                        `   ‚Ä¢ Mercredi: ${Math.round(site.dailyRevenue * 1.1)}‚Ç¨\n` +
                        `   ‚Ä¢ Jeudi: ${Math.round(site.dailyRevenue * 1.2)}‚Ç¨\n` +
                        `   ‚Ä¢ Vendredi: ${Math.round(site.dailyRevenue * 1.4)}‚Ç¨\n` +
                        `   ‚Ä¢ Samedi: ${Math.round(site.dailyRevenue * 1.6)}‚Ç¨\n` +
                        `   ‚Ä¢ Dimanche: ${Math.round(site.dailyRevenue * 1.3)}‚Ç¨\n\n` +
                        `‚≠ê Indicateurs qualit√©:\n` +
                        `   ‚Ä¢ Score global: ${site.score}%\n` +
                        `   ‚Ä¢ Satisfaction client: ${Math.floor(Math.random() * 10) + 85}%\n` +
                        `   ‚Ä¢ Temps d'attente moyen: ${Math.floor(Math.random() * 5) + 8}min\n\n` +
                        `üìÖ Prochaines actions:\n` +
                        `   ‚Ä¢ Visite manager: ${new Date(Date.now() + Math.random() * 14 * 24 * 60 * 60 * 1000).toLocaleDateString('fr-FR')}\n` +
                        `   ‚Ä¢ Formation √©quipe: Planifi√©e\n` +
                        `   ‚Ä¢ Audit qualit√©: En attente`, 'success')}
                    >
                      Rapport
                    </button>
                    <button 
                      className="text-purple-600 hover:text-purple-900"
                      onClick={() => showModal(`Audit ${site.name}`, 
                        `üîç AUDIT QUALIT√â - ${site.name}\n\n` +
                        `üìä Dernier audit: ${new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toLocaleDateString('fr-FR')}\n` +
                        `‚≠ê Score obtenu: ${site.score}%\n\n` +
                        `‚úÖ Points forts:\n` +
                        `   ‚Ä¢ Propret√© cuisine: Excellent\n` +
                        `   ‚Ä¢ Qualit√© produits: Tr√®s bon\n` +
                        `   ‚Ä¢ Accueil client: Bon\n\n` +
                        `‚ö†Ô∏è Points d'am√©lioration:\n` +
                        `   ‚Ä¢ Temps de service: ${site.score < 85 ? '√Ä am√©liorer' : 'Correct'}\n` +
                        `   ‚Ä¢ Pr√©sentation plats: ${site.score < 80 ? 'Insuffisant' : 'Correct'}\n` +
                        `   ‚Ä¢ Proc√©dures fermeture: ${site.score < 90 ? '√Ä revoir' : 'Conforme'}\n\n` +
                        `üéØ Actions correctives:\n` +
                        `   ${site.score < 85 ? '‚Ä¢ Formation service rapide\n   ‚Ä¢ R√©vision proc√©dures\n   ‚Ä¢ Suivi hebdomadaire' : '‚Ä¢ Maintenir les standards\n   ‚Ä¢ Audit de suivi dans 3 mois'}\n\n` +
                        `üìÖ Prochain audit programm√©:\n` +
                        `   ‚Ä¢ Date: ${new Date(Date.now() + Math.random() * 60 * 24 * 60 * 60 * 1000).toLocaleDateString('fr-FR')}\n` +
                        `   ‚Ä¢ Type: ${site.score < 85 ? 'Audit de suivi' : 'Audit standard'}\n` +
                        `   ‚Ä¢ Auditeur: ${['Marie Dubois', 'Pierre Leroy', 'Sophie Martin'][Math.floor(Math.random() * 3)]}`, 'info')}
                    >
                      Audit
                    </button>
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>


    </div>
  );
};

const SitesManagement = ({ sites = [], showModal }) => {
  const [showAddModal, setShowAddModal] = useState(false);
  const [newSite, setNewSite] = useState({
    name: '',
    location: '',
    manager: '',
    phone: '',
    email: ''
  });

  const handleAddSite = () => {
    if (newSite.name && newSite.location) {
      // Simulate adding the site
      console.log('Nouveau site ajout√©:', newSite);
      showModal('Site Ajout√© avec Succ√®s', 
        `‚úÖ NOUVEAU SITE CR√â√â\n\n` +
        `üè™ Nom: ${newSite.name}\n` +
        `üìç Adresse: ${newSite.location}\n` +
        `üë§ Manager: ${newSite.manager || '√Ä assigner'}\n` +
        `üìû T√©l√©phone: ${newSite.phone || '√Ä renseigner'}\n` +
        `üìß Email: ${newSite.email || '√Ä renseigner'}\n\n` +
        `üéØ Prochaines √©tapes:\n` +
        `   ‚Ä¢ Configuration des standards\n` +
        `   ‚Ä¢ Formation de l'√©quipe\n` +
        `   ‚Ä¢ Installation du syst√®me\n` +
        `   ‚Ä¢ Audit d'ouverture\n\n` +
        `üìÖ Ouverture pr√©vue: ${new Date(Date.now() + 21 * 24 * 60 * 60 * 1000).toLocaleDateString('fr-FR')}\n\n` +
        `Le site appara√Ætra dans la liste apr√®s validation.`, 'success');
      
      setShowAddModal(false);
      setNewSite({ name: '', location: '', manager: '', phone: '', email: '' });
    }
  };

  return (
    <div className="space-y-6">
      <div className="flex justify-between items-center">
        <h3 className="text-lg font-medium text-gray-900">Gestion des sites</h3>
        <button 
          className="btn btn-primary"
          onClick={() => setShowAddModal(true)}
        >
          Ajouter un site
        </button>
      </div>

      {/* Modal d'ajout de site */}
      {showAddModal && (
        <div className="fixed inset-0 z-50 overflow-y-auto">
          <div className="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div className="fixed inset-0 transition-opacity" onClick={() => setShowAddModal(false)}>
              <div className="absolute inset-0 bg-gray-500 opacity-75"></div>
            </div>

            <div className="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
              <div className="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                <h3 className="text-lg font-medium text-gray-900 mb-4">Ajouter un nouveau site</h3>
                
                <div className="space-y-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Nom du site *</label>
                    <input
                      type="text"
                      className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                      value={newSite.name}
                      onChange={(e) => setNewSite({...newSite, name: e.target.value})}
                      placeholder="Ex: Restaurant Paris Centre"
                    />
                  </div>
                  
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Adresse *</label>
                    <input
                      type="text"
                      className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                      value={newSite.location}
                      onChange={(e) => setNewSite({...newSite, location: e.target.value})}
                      placeholder="Ex: 123 Rue de la Paix, 75001 Paris"
                    />
                  </div>
                  
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Manager</label>
                    <input
                      type="text"
                      className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                      value={newSite.manager}
                      onChange={(e) => setNewSite({...newSite, manager: e.target.value})}
                      placeholder="Nom du responsable"
                    />
                  </div>
                  
                  <div>
                    <label className="block text-sm font-medium text-gray-700">T√©l√©phone</label>
                    <input
                      type="tel"
                      className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                      value={newSite.phone}
                      onChange={(e) => setNewSite({...newSite, phone: e.target.value})}
                      placeholder="01 23 45 67 89"
                    />
                  </div>
                  
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Email</label>
                    <input
                      type="email"
                      className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                      value={newSite.email}
                      onChange={(e) => setNewSite({...newSite, email: e.target.value})}
                      placeholder="site@restaurant.com"
                    />
                  </div>
                </div>
              </div>
              
              <div className="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                <button
                  type="button"
                  onClick={handleAddSite}
                  disabled={!newSite.name || !newSite.location}
                  className="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  Ajouter
                </button>
                <button
                  type="button"
                  onClick={() => setShowAddModal(false)}
                  className="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"
                >
                  Annuler
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {sites.map((site) => (
          <div key={site.id} className="card">
            <div className="flex items-center justify-between mb-4">
              <h4 className="text-lg font-medium text-gray-900">{site.name}</h4>
              <span className={`px-2 py-1 text-xs rounded-full ${
                site.status === 'active' ? 'bg-green-100 text-green-800' : 'bg-red-100 text-red-800'
              }`}>
                {site.status === 'active' ? 'Actif' : 'Inactif'}
              </span>
            </div>
            
            <div className="space-y-2 text-sm text-gray-600">
              <p><strong>Adresse:</strong> {site.location}</p>
              <p><strong>Manager:</strong> {site.manager || 'Non assign√©'}</p>
              <p><strong>CA aujourd'hui:</strong> {site.dailyRevenue || 0}‚Ç¨</p>
              <p><strong>Score:</strong> {site.score || 0}%</p>
            </div>
            
            <div className="mt-4 flex space-x-2">
              <button 
                className="btn btn-secondary text-xs"
                onClick={() => showModal(`Modifier ${site.name}`, 
                  `‚úèÔ∏è MODIFICATION DU SITE\n\n` +
                  `üìä Informations actuelles:\n` +
                  `   ‚Ä¢ Nom: ${site.name}\n` +
                  `   ‚Ä¢ Adresse: ${site.location}\n` +
                  `   ‚Ä¢ Manager: ${site.manager || 'Non assign√©'}\n` +
                  `   ‚Ä¢ Statut: ${site.status === 'active' ? 'Actif' : 'Inactif'}\n\n` +
                  `üîß Modifications possibles:\n` +
                  `   ‚Ä¢ Changer le manager\n` +
                  `   ‚Ä¢ Mettre √† jour les coordonn√©es\n` +
                  `   ‚Ä¢ Modifier les horaires\n` +
                  `   ‚Ä¢ Ajuster la capacit√©\n` +
                  `   ‚Ä¢ Configurer les standards\n\n` +
                  `‚ö†Ô∏è Attention:\n` +
                  `Certaines modifications peuvent n√©cessiter une validation du si√®ge et impacter les op√©rations en cours.\n\n` +
                  `Pour effectuer les modifications, contactez l'administrateur syst√®me.`, 'warning')}
              >
                Modifier
              </button>
              <button 
                className="btn btn-primary text-xs"
                onClick={() => showModal(`D√©tails ${site.name}`, 
                  `üìä FICHE D√âTAILL√âE DU SITE\n\n` +
                  `üè™ Informations g√©n√©rales:\n` +
                  `   ‚Ä¢ Nom complet: ${site.name}\n` +
                  `   ‚Ä¢ Adresse: ${site.location}\n` +
                  `   ‚Ä¢ Manager: ${site.manager || 'Non assign√©'}\n` +
                  `   ‚Ä¢ Statut: ${site.status === 'active' ? 'üü¢ Actif' : 'üî¥ Inactif'}\n\n` +
                  `üí∞ Performance aujourd'hui:\n` +
                  `   ‚Ä¢ Chiffre d'affaires: ${site.dailyRevenue || 0}‚Ç¨\n` +
                  `   ‚Ä¢ Nombre de commandes: ${Math.floor(Math.random() * 50) + 80}\n` +
                  `   ‚Ä¢ Ticket moyen: ${Math.round((site.dailyRevenue || 0) / (Math.floor(Math.random() * 50) + 80))}‚Ç¨\n\n` +
                  `‚≠ê Qualit√© et performance:\n` +
                  `   ‚Ä¢ Score global: ${site.score || 0}%\n` +
                  `   ‚Ä¢ Satisfaction client: ${Math.floor(Math.random() * 10) + 85}%\n` +
                  `   ‚Ä¢ Temps d'attente moyen: ${Math.floor(Math.random() * 5) + 8}min\n` +
                  `   ‚Ä¢ Taux de conformit√©: ${Math.floor(Math.random() * 15) + 85}%\n\n` +
                  `üë• √âquipe (${Math.floor(Math.random() * 8) + 12} employ√©s):\n` +
                  `   ‚Ä¢ Manager: 1\n` +
                  `   ‚Ä¢ Chefs: ${Math.floor(Math.random() * 3) + 2}\n` +
                  `   ‚Ä¢ Serveurs: ${Math.floor(Math.random() * 4) + 4}\n` +
                  `   ‚Ä¢ Personnel cuisine: ${Math.floor(Math.random() * 3) + 3}\n\n` +
                  `üìÖ Derni√®re visite: ${new Date(Date.now() - Math.random() * 30 * 24 * 60 * 60 * 1000).toLocaleDateString('fr-FR')}\n` +
                  `üîç Prochain audit: ${new Date(Date.now() + Math.random() * 30 * 24 * 60 * 60 * 1000).toLocaleDateString('fr-FR')}`, 'info')}
              >
                D√©tails
              </button>
            </div>
          </div>
        ))}
      </div>
    </div>
  );
};

const StandardsManagement = ({ showModal }) => {
  const [showStandardModal, setShowStandardModal] = useState(false);
  const [newStandard, setNewStandard] = useState({
    name: '',
    type: 'recipe',
    description: '',
    content: ''
  });

  const handleCreateStandard = () => {
    if (newStandard.name && newStandard.type) {
      console.log('Nouveau standard cr√©√©:', newStandard);
      showModal('Standard Cr√©√© avec Succ√®s', 
        `‚úÖ NOUVEAU STANDARD AJOUT√â\n\n` +
        `üìã D√©tails du standard:\n` +
        `   ‚Ä¢ Nom: ${newStandard.name}\n` +
        `   ‚Ä¢ Type: ${newStandard.type === 'recipe' ? 'Recette standardis√©e' : 
                     newStandard.type === 'procedure' ? 'Proc√©dure' :
                     newStandard.type === 'checklist' ? 'Check-list' : 'Formation'}\n` +
        `   ‚Ä¢ Description: ${newStandard.description || 'Aucune description'}\n\n` +
        `üéØ D√©ploiement:\n` +
        `   ‚Ä¢ Statut: En attente de validation\n` +
        `   ‚Ä¢ Sites concern√©s: Tous (${Math.floor(Math.random() * 3) + 3} sites)\n` +
        `   ‚Ä¢ Formation requise: ${newStandard.type === 'training' ? 'Oui' : 'Non'}\n\n` +
        `üìÖ Planning de d√©ploiement:\n` +
        `   ‚Ä¢ Validation: ${new Date(Date.now() + 2 * 24 * 60 * 60 * 1000).toLocaleDateString('fr-FR')}\n` +
        `   ‚Ä¢ Formation √©quipes: ${new Date(Date.now() + 7 * 24 * 60 * 60 * 1000).toLocaleDateString('fr-FR')}\n` +
        `   ‚Ä¢ Mise en application: ${new Date(Date.now() + 14 * 24 * 60 * 60 * 1000).toLocaleDateString('fr-FR')}\n\n` +
        `Le standard sera visible dans la liste apr√®s validation.`, 'success');
      
      setShowStandardModal(false);
      setNewStandard({ name: '', type: 'recipe', description: '', content: '' });
    }
  };

  return (
    <div className="space-y-6">
      <div className="flex justify-between items-center">
        <h3 className="text-lg font-medium text-gray-900">Standards et Templates</h3>
        <button 
          className="btn btn-primary"
          onClick={() => setShowStandardModal(true)}
        >
          Nouveau standard
        </button>
      </div>

      {/* Modal de cr√©ation de standard */}
      {showStandardModal && (
        <div className="fixed inset-0 z-50 overflow-y-auto">
          <div className="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div className="fixed inset-0 transition-opacity" onClick={() => setShowStandardModal(false)}>
              <div className="absolute inset-0 bg-gray-500 opacity-75"></div>
            </div>

            <div className="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
              <div className="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                <h3 className="text-lg font-medium text-gray-900 mb-4">Cr√©er un nouveau standard</h3>
                
                <div className="space-y-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Nom du standard *</label>
                    <input
                      type="text"
                      className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                      value={newStandard.name}
                      onChange={(e) => setNewStandard({...newStandard, name: e.target.value})}
                      placeholder="Ex: Proc√©dure d'ouverture"
                    />
                  </div>
                  
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Type *</label>
                    <select
                      className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                      value={newStandard.type}
                      onChange={(e) => setNewStandard({...newStandard, type: e.target.value})}
                    >
                      <option value="recipe">Recette standardis√©e</option>
                      <option value="procedure">Proc√©dure</option>
                      <option value="checklist">Check-list</option>
                      <option value="training">Formation</option>
                    </select>
                  </div>
                  
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Description</label>
                    <textarea
                      rows={3}
                      className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                      value={newStandard.description}
                      onChange={(e) => setNewStandard({...newStandard, description: e.target.value})}
                      placeholder="Description du standard..."
                    />
                  </div>
                </div>
              </div>
              
              <div className="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                <button
                  type="button"
                  onClick={handleCreateStandard}
                  disabled={!newStandard.name || !newStandard.type}
                  className="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  Cr√©er
                </button>
                <button
                  type="button"
                  onClick={() => setShowStandardModal(false)}
                  className="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"
                >
                  Annuler
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      <div className="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <div className="card">
          <h4 className="text-lg font-medium text-gray-900 mb-4">Recettes standardis√©es</h4>
          <div className="space-y-3">
            <div className="flex justify-between items-center p-3 bg-gray-50 rounded hover:bg-gray-100 transition-colors">
              <div className="flex-1">
                <span className="font-medium">Burger Classic</span>
                <div className="text-sm text-green-600">D√©ploy√© sur 12 sites</div>
              </div>
              <div className="flex space-x-2">
                <button 
                  className="text-blue-600 hover:text-blue-800 text-sm"
                  onClick={() => showModal('Modifier Burger Classic', 
                    `‚úèÔ∏è MODIFICATION RECETTE STANDARD\n\n` +
                    `üçî Recette: Burger Classic\n` +
                    `üìä Statut: D√©ploy√© sur 12 sites\n` +
                    `‚≠ê Score qualit√©: 94%\n\n` +
                    `üìã Ingr√©dients standardis√©s:\n` +
                    `   ‚Ä¢ Pain burger: 1 unit√© (80g)\n` +
                    `   ‚Ä¢ Steak hach√©: 1 pi√®ce (120g)\n` +
                    `   ‚Ä¢ Fromage cheddar: 1 tranche (20g)\n` +
                    `   ‚Ä¢ Salade iceberg: 15g\n` +
                    `   ‚Ä¢ Tomate: 2 tranches (30g)\n` +
                    `   ‚Ä¢ Sauce burger: 15ml\n\n` +
                    `üîß Modifications possibles:\n` +
                    `   ‚Ä¢ Ajuster les quantit√©s\n` +
                    `   ‚Ä¢ Modifier les ingr√©dients\n` +
                    `   ‚Ä¢ Changer la pr√©sentation\n` +
                    `   ‚Ä¢ Mettre √† jour les instructions\n\n` +
                    `‚ö†Ô∏è Impact du changement:\n` +
                    `   ‚Ä¢ Formation requise: 12 sites\n` +
                    `   ‚Ä¢ Co√ªt formation: ~2,400‚Ç¨\n` +
                    `   ‚Ä¢ D√©lai d√©ploiement: 2 semaines`, 'warning')}
                >
                  Modifier
                </button>
                <button 
                  className="text-green-600 hover:text-green-800 text-sm"
                  onClick={() => showModal('D√©tails Burger Classic', 
                    `üçî FICHE TECHNIQUE - BURGER CLASSIC\n\n` +
                    `üìä Informations g√©n√©rales:\n` +
                    `   ‚Ä¢ Nom: Burger Classic\n` +
                    `   ‚Ä¢ Cat√©gorie: Plat principal\n` +
                    `   ‚Ä¢ Temps pr√©paration: 8 minutes\n` +
                    `   ‚Ä¢ Difficult√©: Facile\n` +
                    `   ‚Ä¢ Prix de revient: 3.85‚Ç¨\n` +
                    `   ‚Ä¢ Prix de vente: 12.90‚Ç¨\n` +
                    `   ‚Ä¢ Marge: 70%\n\n` +
                    `üìã Ingr√©dients (pour 1 portion):\n` +
                    `   ‚Ä¢ Pain burger artisanal: 80g\n` +
                    `   ‚Ä¢ Steak hach√© 15% MG: 120g\n` +
                    `   ‚Ä¢ Fromage cheddar: 20g\n` +
                    `   ‚Ä¢ Salade iceberg: 15g\n` +
                    `   ‚Ä¢ Tomate fra√Æche: 30g\n` +
                    `   ‚Ä¢ Sauce burger maison: 15ml\n\n` +
                    `üë®‚Äçüç≥ Instructions:\n` +
                    `   1. Griller le pain (2min)\n` +
                    `   2. Cuire le steak (4min)\n` +
                    `   3. Assembler dans l'ordre\n` +
                    `   4. Servir avec frites\n\n` +
                    `üìà Performance:\n` +
                    `   ‚Ä¢ Ventes/jour: 45 unit√©s (moyenne)\n` +
                    `   ‚Ä¢ Satisfaction: 4.6/5\n` +
                    `   ‚Ä¢ Conformit√©: 98%`, 'info')}
                >
                  D√©tails
                </button>
              </div>
            </div>
            <div className="flex justify-between items-center p-3 bg-gray-50 rounded hover:bg-gray-100 transition-colors">
              <div className="flex-1">
                <span className="font-medium">Pizza Margherita</span>
                <div className="text-sm text-green-600">D√©ploy√© sur 8 sites</div>
              </div>
              <div className="flex space-x-2">
                <button 
                  className="text-blue-600 hover:text-blue-800 text-sm"
                  onClick={() => showModal('Modifier Pizza Margherita', 
                    `‚úèÔ∏è MODIFICATION RECETTE STANDARD\n\n` +
                    `üçï Recette: Pizza Margherita\n` +
                    `üìä Statut: D√©ploy√© sur 8 sites\n` +
                    `‚≠ê Score qualit√©: 91%\n\n` +
                    `üìã Ingr√©dients standardis√©s:\n` +
                    `   ‚Ä¢ P√¢te √† pizza: 250g\n` +
                    `   ‚Ä¢ Sauce tomate: 80ml\n` +
                    `   ‚Ä¢ Mozzarella: 120g\n` +
                    `   ‚Ä¢ Basilic frais: 5 feuilles\n` +
                    `   ‚Ä¢ Huile d'olive: 10ml\n\n` +
                    `üîß Modifications possibles:\n` +
                    `   ‚Ä¢ Ajuster l'√©paisseur p√¢te\n` +
                    `   ‚Ä¢ Modifier la sauce\n` +
                    `   ‚Ä¢ Changer le fromage\n` +
                    `   ‚Ä¢ Temps de cuisson\n\n` +
                    `‚ö†Ô∏è Impact du changement:\n` +
                    `   ‚Ä¢ Formation requise: 8 sites\n` +
                    `   ‚Ä¢ Co√ªt formation: ~1,600‚Ç¨\n` +
                    `   ‚Ä¢ D√©lai d√©ploiement: 10 jours`, 'warning')}
                >
                  Modifier
                </button>
                <button 
                  className="text-green-600 hover:text-green-800 text-sm"
                  onClick={() => showModal('D√©tails Pizza Margherita', 
                    `üçï FICHE TECHNIQUE - PIZZA MARGHERITA\n\n` +
                    `üìä Informations g√©n√©rales:\n` +
                    `   ‚Ä¢ Nom: Pizza Margherita\n` +
                    `   ‚Ä¢ Cat√©gorie: Pizza\n` +
                    `   ‚Ä¢ Temps pr√©paration: 12 minutes\n` +
                    `   ‚Ä¢ Temps cuisson: 8 minutes\n` +
                    `   ‚Ä¢ Difficult√©: Moyenne\n` +
                    `   ‚Ä¢ Prix de revient: 4.20‚Ç¨\n` +
                    `   ‚Ä¢ Prix de vente: 14.50‚Ç¨\n` +
                    `   ‚Ä¢ Marge: 71%\n\n` +
                    `üìã Ingr√©dients (pour 1 pizza):\n` +
                    `   ‚Ä¢ P√¢te √† pizza maison: 250g\n` +
                    `   ‚Ä¢ Sauce tomate basilic: 80ml\n` +
                    `   ‚Ä¢ Mozzarella di bufala: 120g\n` +
                    `   ‚Ä¢ Basilic frais: 5 feuilles\n` +
                    `   ‚Ä¢ Huile d'olive extra: 10ml\n\n` +
                    `üë®‚Äçüç≥ Instructions:\n` +
                    `   1. √âtaler la p√¢te (√ò 30cm)\n` +
                    `   2. Napper de sauce\n` +
                    `   3. Ajouter la mozzarella\n` +
                    `   4. Cuire √† 280¬∞C (8min)\n` +
                    `   5. Garnir de basilic\n\n` +
                    `üìà Performance:\n` +
                    `   ‚Ä¢ Ventes/jour: 32 unit√©s (moyenne)\n` +
                    `   ‚Ä¢ Satisfaction: 4.4/5\n` +
                    `   ‚Ä¢ Conformit√©: 95%`, 'info')}
                >
                  D√©tails
                </button>
              </div>
            </div>
            <div className="flex justify-between items-center p-3 bg-gray-50 rounded hover:bg-gray-100 transition-colors">
              <div className="flex-1">
                <span className="font-medium">Salade C√©sar</span>
                <div className="text-sm text-yellow-600">En cours de d√©ploiement</div>
              </div>
              <div className="flex space-x-2">
                <button 
                  className="text-blue-600 hover:text-blue-800 text-sm"
                  onClick={() => showModal('Modifier Salade C√©sar', 
                    `‚úèÔ∏è MODIFICATION RECETTE STANDARD\n\n` +
                    `ü•ó Recette: Salade C√©sar\n` +
                    `üìä Statut: En cours de d√©ploiement (3/5 sites)\n` +
                    `‚≠ê Score qualit√©: 89%\n\n` +
                    `üìã Ingr√©dients standardis√©s:\n` +
                    `   ‚Ä¢ Salade romaine: 150g\n` +
                    `   ‚Ä¢ Poulet grill√©: 100g\n` +
                    `   ‚Ä¢ Parmesan: 30g\n` +
                    `   ‚Ä¢ Cro√ªtons: 25g\n` +
                    `   ‚Ä¢ Sauce C√©sar: 40ml\n\n` +
                    `üîß Modifications possibles:\n` +
                    `   ‚Ä¢ Ajuster les portions\n` +
                    `   ‚Ä¢ Modifier la sauce\n` +
                    `   ‚Ä¢ Changer le type de salade\n` +
                    `   ‚Ä¢ Ajouter des ingr√©dients\n\n` +
                    `‚ö†Ô∏è Impact du changement:\n` +
                    `   ‚Ä¢ Sites en attente: 2\n` +
                    `   ‚Ä¢ Formation suppl√©mentaire requise\n` +
                    `   ‚Ä¢ D√©lai d√©ploiement: +1 semaine`, 'warning')}
                >
                  Modifier
                </button>
                <button 
                  className="text-yellow-600 hover:text-yellow-800 text-sm"
                  onClick={() => showModal('D√©tails Salade C√©sar', 
                    `ü•ó FICHE TECHNIQUE - SALADE C√âSAR\n\n` +
                    `üìä Informations g√©n√©rales:\n` +
                    `   ‚Ä¢ Nom: Salade C√©sar\n` +
                    `   ‚Ä¢ Cat√©gorie: Entr√©e/Plat l√©ger\n` +
                    `   ‚Ä¢ Temps pr√©paration: 6 minutes\n` +
                    `   ‚Ä¢ Difficult√©: Facile\n` +
                    `   ‚Ä¢ Prix de revient: 3.10‚Ç¨\n` +
                    `   ‚Ä¢ Prix de vente: 11.90‚Ç¨\n` +
                    `   ‚Ä¢ Marge: 74%\n\n` +
                    `üìã Ingr√©dients (pour 1 portion):\n` +
                    `   ‚Ä¢ Salade romaine: 150g\n` +
                    `   ‚Ä¢ Blanc de poulet grill√©: 100g\n` +
                    `   ‚Ä¢ Parmesan r√¢p√©: 30g\n` +
                    `   ‚Ä¢ Cro√ªtons maison: 25g\n` +
                    `   ‚Ä¢ Sauce C√©sar: 40ml\n\n` +
                    `üë®‚Äçüç≥ Instructions:\n` +
                    `   1. Laver et couper la salade\n` +
                    `   2. Griller le poulet (5min)\n` +
                    `   3. Pr√©parer les cro√ªtons\n` +
                    `   4. Assembler et assaisonner\n\n` +
                    `üìà D√©ploiement:\n` +
                    `   ‚Ä¢ Sites actifs: 3/5\n` +
                    `   ‚Ä¢ Formation en cours: 2 sites\n` +
                    `   ‚Ä¢ Lancement pr√©vu: 15 janvier`, 'warning')}
                >
                  D√©tails
                </button>
              </div>
            </div>
          </div>
        </div>

        <div className="card">
          <h4 className="text-lg font-medium text-gray-900 mb-4">Proc√©dures</h4>
          <div className="space-y-3">
            <div className="flex justify-between items-center p-3 bg-gray-50 rounded hover:bg-gray-100 transition-colors">
              <div className="flex-1">
                <span className="font-medium">Ouverture quotidienne</span>
                <div className="text-sm text-green-600">100% conformit√©</div>
              </div>
              <div className="flex space-x-2">
                <button 
                  className="text-blue-600 hover:text-blue-800 text-sm"
                  onClick={() => showModal('Modifier Proc√©dure Ouverture', 
                    `‚úèÔ∏è MODIFICATION PROC√âDURE\n\n` +
                    `üè™ Proc√©dure: Ouverture quotidienne\n` +
                    `üìä Conformit√© actuelle: 100%\n` +
                    `‚≠ê Performance: Excellente\n\n` +
                    `üìã √âtapes actuelles:\n` +
                    `   1. D√©sactivation alarme (7h00)\n` +
                    `   2. V√©rification temp√©rature frigos\n` +
                    `   3. Contr√¥le propret√© surfaces\n` +
                    `   4. Mise en route √©quipements\n` +
                    `   5. Pr√©paration caisse\n` +
                    `   6. Briefing √©quipe (7h30)\n` +
                    `   7. Ouverture au public (8h00)\n\n` +
                    `üîß Modifications possibles:\n` +
                    `   ‚Ä¢ Ajuster les horaires\n` +
                    `   ‚Ä¢ Ajouter des contr√¥les\n` +
                    `   ‚Ä¢ Modifier l'ordre des t√¢ches\n` +
                    `   ‚Ä¢ Changer les responsabilit√©s\n\n` +
                    `‚úÖ Recommandation:\n` +
                    `Cette proc√©dure fonctionne parfaitement. √âvitez les modifications non n√©cessaires.`, 'success')}
                >
                  Modifier
                </button>
                <button 
                  className="text-green-600 hover:text-green-800 text-sm"
                  onClick={() => showModal('D√©tails Proc√©dure Ouverture', 
                    `üè™ PROC√âDURE - OUVERTURE QUOTIDIENNE\n\n` +
                    `üìä Informations g√©n√©rales:\n` +
                    `   ‚Ä¢ Nom: Ouverture quotidienne\n` +
                    `   ‚Ä¢ Type: Proc√©dure op√©rationnelle\n` +
                    `   ‚Ä¢ Fr√©quence: Quotidienne\n` +
                    `   ‚Ä¢ Dur√©e: 60 minutes\n` +
                    `   ‚Ä¢ Responsable: Manager/Chef d'√©quipe\n\n` +
                    `üìã Check-list d√©taill√©e:\n` +
                    `   ‚úÖ 7h00 - D√©sactivation alarme\n` +
                    `   ‚úÖ 7h05 - Contr√¥le temp√©rature (-2¬∞C √† +4¬∞C)\n` +
                    `   ‚úÖ 7h10 - V√©rification propret√© (surfaces, sols)\n` +
                    `   ‚úÖ 7h15 - Mise en route √©quipements\n` +
                    `   ‚úÖ 7h20 - Pr√©paration caisse (fond de caisse)\n` +
                    `   ‚úÖ 7h25 - V√©rification stocks urgents\n` +
                    `   ‚úÖ 7h30 - Briefing √©quipe (objectifs, promos)\n` +
                    `   ‚úÖ 7h55 - Contr√¥le final\n` +
                    `   ‚úÖ 8h00 - Ouverture au public\n\n` +
                    `üìà Performance par site:\n` +
                    `   ‚Ä¢ Paris: 100% (Excellent)\n` +
                    `   ‚Ä¢ Lyon: 100% (Excellent)\n` +
                    `   ‚Ä¢ Toulouse: 100% (Excellent)\n` +
                    `   ‚Ä¢ Nice: 100% (Excellent)\n` +
                    `   ‚Ä¢ Marseille: 100% (Excellent)\n\n` +
                    `üéØ Cette proc√©dure est un mod√®le de r√©ussite !`, 'success')}
                >
                  D√©tails
                </button>
              </div>
            </div>
            <div className="flex justify-between items-center p-3 bg-gray-50 rounded hover:bg-gray-100 transition-colors">
              <div className="flex-1">
                <span className="font-medium">Nettoyage cuisine</span>
                <div className="text-sm text-green-600">95% conformit√©</div>
              </div>
              <div className="flex space-x-2">
                <button 
                  className="text-blue-600 hover:text-blue-800 text-sm"
                  onClick={() => showModal('Modifier Proc√©dure Nettoyage', 
                    `‚úèÔ∏è MODIFICATION PROC√âDURE\n\n` +
                    `üßΩ Proc√©dure: Nettoyage cuisine\n` +
                    `üìä Conformit√© actuelle: 95%\n` +
                    `‚ö†Ô∏è Site en difficult√©: Nice (88%)\n\n` +
                    `üìã √âtapes actuelles:\n` +
                    `   1. Nettoyage surfaces (apr√®s chaque service)\n` +
                    `   2. D√©sinfection plans de travail\n` +
                    `   3. Nettoyage √©quipements\n` +
                    `   4. Lavage sols et murs\n` +
                    `   5. Contr√¥le temp√©rature frigos\n` +
                    `   6. √âvacuation d√©chets\n\n` +
                    `üîß Am√©liorations sugg√©r√©es:\n` +
                    `   ‚Ä¢ Renforcer formation Nice\n` +
                    `   ‚Ä¢ Ajouter contr√¥le interm√©diaire\n` +
                    `   ‚Ä¢ Clarifier responsabilit√©s\n` +
                    `   ‚Ä¢ Mettre √† jour produits\n\n` +
                    `üéØ Objectif: Atteindre 98% de conformit√©`, 'warning')}
                >
                  Modifier
                </button>
                <button 
                  className="text-green-600 hover:text-green-800 text-sm"
                  onClick={() => showModal('D√©tails Proc√©dure Nettoyage', 
                    `üßΩ PROC√âDURE - NETTOYAGE CUISINE\n\n` +
                    `üìä Informations g√©n√©rales:\n` +
                    `   ‚Ä¢ Nom: Nettoyage cuisine\n` +
                    `   ‚Ä¢ Type: Proc√©dure hygi√®ne\n` +
                    `   ‚Ä¢ Fr√©quence: Continue + quotidienne\n` +
                    `   ‚Ä¢ Dur√©e: 45 minutes (fin de service)\n` +
                    `   ‚Ä¢ Responsable: Chef de cuisine\n\n` +
                    `üìã Protocole d√©taill√©:\n` +
                    `   üßΩ Nettoyage imm√©diat (apr√®s chaque plat)\n` +
                    `   üß¥ D√©sinfection surfaces (toutes les 2h)\n` +
                    `   üîß Nettoyage √©quipements (fin service)\n` +
                    `   üßπ Lavage sols et murs (fermeture)\n` +
                    `   üå°Ô∏è Contr√¥le temp√©ratures (3x/jour)\n` +
                    `   üóëÔ∏è √âvacuation d√©chets (fermeture)\n\n` +
                    `üìà Performance par site:\n` +
                    `   ‚Ä¢ Paris: 98% (Excellent)\n` +
                    `   ‚Ä¢ Lyon: 96% (Tr√®s bon)\n` +
                    `   ‚Ä¢ Toulouse: 94% (Bon)\n` +
                    `   ‚Ä¢ Marseille: 92% (Correct)\n` +
                    `   ‚Ä¢ Nice: 88% (√Ä am√©liorer)\n\n` +
                    `‚ö†Ô∏è Action requise: Formation Nice programm√©e`, 'info')}
                >
                  D√©tails
                </button>
              </div>
            </div>
            <div className="flex justify-between items-center p-3 bg-gray-50 rounded hover:bg-gray-100 transition-colors">
              <div className="flex-1">
                <span className="font-medium">Fermeture caisse</span>
                <div className="text-sm text-red-600">85% conformit√©</div>
              </div>
              <div className="flex space-x-2">
                <button 
                  className="text-blue-600 hover:text-blue-800 text-sm"
                  onClick={() => showModal('Modifier Proc√©dure Fermeture Caisse', 
                    `‚úèÔ∏è MODIFICATION PROC√âDURE URGENTE\n\n` +
                    `üí∞ Proc√©dure: Fermeture caisse\n` +
                    `üìä Conformit√© actuelle: 85%\n` +
                    `‚ùå Sites en difficult√©: Marseille (75%), Nice (80%)\n\n` +
                    `üìã Probl√®mes identifi√©s:\n` +
                    `   ‚Ä¢ Comptage incomplet\n` +
                    `   ‚Ä¢ Rapprochement bancaire manqu√©\n` +
                    `   ‚Ä¢ Documentation insuffisante\n` +
                    `   ‚Ä¢ Retards de transmission\n\n` +
                    `üîß Modifications urgentes:\n` +
                    `   ‚Ä¢ Double contr√¥le obligatoire\n` +
                    `   ‚Ä¢ Check-list d√©taill√©e\n` +
                    `   ‚Ä¢ Formation renforc√©e\n` +
                    `   ‚Ä¢ Supervision manager\n\n` +
                    `‚ö†Ô∏è PRIORIT√â HAUTE\n` +
                    `Cette proc√©dure impacte la s√©curit√© financi√®re. Modification imm√©diate recommand√©e.`, 'error')}
                >
                  Modifier
                </button>
                <button 
                  className="text-red-600 hover:text-red-800 text-sm"
                  onClick={() => showModal('D√©tails Proc√©dure Fermeture Caisse', 
                    `üí∞ PROC√âDURE - FERMETURE CAISSE\n\n` +
                    `üìä Informations g√©n√©rales:\n` +
                    `   ‚Ä¢ Nom: Fermeture caisse\n` +
                    `   ‚Ä¢ Type: Proc√©dure financi√®re\n` +
                    `   ‚Ä¢ Fr√©quence: Quotidienne\n` +
                    `   ‚Ä¢ Dur√©e: 30 minutes\n` +
                    `   ‚Ä¢ Responsable: Manager + Caissier\n\n` +
                    `üìã √âtapes actuelles:\n` +
                    `   üíµ Comptage esp√®ces\n` +
                    `   üí≥ V√©rification CB/ch√®ques\n` +
                    `   üìä √âdition rapport Z\n` +
                    `   üìù Rapprochement bancaire\n` +
                    `   üìÅ Archivage documents\n` +
                    `   üìß Transmission si√®ge\n\n` +
                    `‚ùå Performance par site:\n` +
                    `   ‚Ä¢ Paris: 95% (Bon)\n` +
                    `   ‚Ä¢ Lyon: 90% (Correct)\n` +
                    `   ‚Ä¢ Toulouse: 88% (Limite)\n` +
                    `   ‚Ä¢ Nice: 80% (Insuffisant)\n` +
                    `   ‚Ä¢ Marseille: 75% (Critique)\n\n` +
                    `üö® ACTIONS IMM√âDIATES:\n` +
                    `   ‚Ä¢ Audit surprise Marseille\n` +
                    `   ‚Ä¢ Formation d'urgence Nice\n` +
                    `   ‚Ä¢ Supervision renforc√©e`, 'error')}
                >
                  D√©tails
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};

const AuditsManagement = ({ showModal }) => {
  const [showAuditModal, setShowAuditModal] = useState(false);
  const [newAudit, setNewAudit] = useState({
    site: '',
    date: '',
    time: '',
    auditor: '',
    type: 'quality'
  });

  const handleScheduleAudit = () => {
    if (newAudit.site && newAudit.date && newAudit.time) {
      console.log('Nouvel audit programm√©:', newAudit);
      showModal('Audit Programm√© avec Succ√®s', 
        `‚úÖ NOUVEL AUDIT PLANIFI√â\n\n` +
        `üîç D√©tails de l'audit:\n` +
        `   ‚Ä¢ Site: ${newAudit.site === 'paris-centre' ? 'Paris Centre' :
                     newAudit.site === 'lyon-partdieu' ? 'Lyon Part-Dieu' :
                     newAudit.site === 'marseille-vieux-port' ? 'Marseille Vieux-Port' :
                     newAudit.site === 'toulouse-capitole' ? 'Toulouse Capitole' : newAudit.site}\n` +
        `   ‚Ä¢ Date: ${new Date(newAudit.date).toLocaleDateString('fr-FR')}\n` +
        `   ‚Ä¢ Heure: ${newAudit.time}\n` +
        `   ‚Ä¢ Type: ${newAudit.type === 'quality' ? 'Contr√¥le qualit√©' :
                      newAudit.type === 'hygiene' ? 'Audit hygi√®ne' :
                      newAudit.type === 'service' ? '√âvaluation service' : 'Conformit√© standards'}\n` +
        `   ‚Ä¢ Auditeur: ${newAudit.auditor || '√Ä assigner'}\n\n` +
        `üìã Pr√©paration automatique:\n` +
        `   ‚Ä¢ Check-list g√©n√©r√©e\n` +
        `   ‚Ä¢ Notification envoy√©e au site\n` +
        `   ‚Ä¢ Rappel programm√© (J-1)\n` +
        `   ‚Ä¢ Rapport template pr√©par√©\n\n` +
        `üìÖ Planning mis √† jour:\n` +
        `L'audit appara√Æt maintenant dans la liste des audits programm√©s.\n\n` +
        `üìß Notifications envoy√©es:\n` +
        `   ‚Ä¢ Manager du site\n` +
        `   ‚Ä¢ √âquipe d'audit\n` +
        `   ‚Ä¢ Direction r√©gionale`, 'success');
      
      setShowAuditModal(false);
      setNewAudit({ site: '', date: '', time: '', auditor: '', type: 'quality' });
    }
  };

  return (
    <div className="space-y-6">
      <div className="flex justify-between items-center">
        <h3 className="text-lg font-medium text-gray-900">Audits et Contr√¥les</h3>
        <button 
          className="btn btn-primary"
          onClick={() => setShowAuditModal(true)}
        >
          Programmer audit
        </button>
      </div>

      {/* Modal de programmation d'audit */}
      {showAuditModal && (
        <div className="fixed inset-0 z-50 overflow-y-auto">
          <div className="flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0">
            <div className="fixed inset-0 transition-opacity" onClick={() => setShowAuditModal(false)}>
              <div className="absolute inset-0 bg-gray-500 opacity-75"></div>
            </div>

            <div className="inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full">
              <div className="bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4">
                <h3 className="text-lg font-medium text-gray-900 mb-4">Programmer un audit</h3>
                
                <div className="space-y-4">
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Site √† auditer *</label>
                    <select
                      className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                      value={newAudit.site}
                      onChange={(e) => setNewAudit({...newAudit, site: e.target.value})}
                    >
                      <option value="">S√©lectionner un site</option>
                      <option value="paris-centre">Paris Centre</option>
                      <option value="lyon-partdieu">Lyon Part-Dieu</option>
                      <option value="marseille-vieux-port">Marseille Vieux-Port</option>
                      <option value="toulouse-capitole">Toulouse Capitole</option>
                    </select>
                  </div>
                  
                  <div className="grid grid-cols-2 gap-4">
                    <div>
                      <label className="block text-sm font-medium text-gray-700">Date *</label>
                      <input
                        type="date"
                        className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        value={newAudit.date}
                        onChange={(e) => setNewAudit({...newAudit, date: e.target.value})}
                      />
                    </div>
                    <div>
                      <label className="block text-sm font-medium text-gray-700">Heure *</label>
                      <input
                        type="time"
                        className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        value={newAudit.time}
                        onChange={(e) => setNewAudit({...newAudit, time: e.target.value})}
                      />
                    </div>
                  </div>
                  
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Type d'audit *</label>
                    <select
                      className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                      value={newAudit.type}
                      onChange={(e) => setNewAudit({...newAudit, type: e.target.value})}
                    >
                      <option value="quality">Contr√¥le qualit√©</option>
                      <option value="hygiene">Audit hygi√®ne</option>
                      <option value="service">√âvaluation service</option>
                      <option value="compliance">Conformit√© standards</option>
                    </select>
                  </div>
                  
                  <div>
                    <label className="block text-sm font-medium text-gray-700">Auditeur</label>
                    <input
                      type="text"
                      className="mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
                      value={newAudit.auditor}
                      onChange={(e) => setNewAudit({...newAudit, auditor: e.target.value})}
                      placeholder="Nom de l'auditeur"
                    />
                  </div>
                </div>
              </div>
              
              <div className="bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse">
                <button
                  type="button"
                  onClick={handleScheduleAudit}
                  disabled={!newAudit.site || !newAudit.date || !newAudit.time}
                  className="w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed"
                >
                  Programmer
                </button>
                <button
                  type="button"
                  onClick={() => setShowAuditModal(false)}
                  className="mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm"
                >
                  Annuler
                </button>
              </div>
            </div>
          </div>
        </div>
      )}

      <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <div className="card">
          <h4 className="text-lg font-medium text-gray-900 mb-4">Audits programm√©s</h4>
          <div className="space-y-3">
            <div className="p-3 border-l-4 border-blue-500 bg-blue-50">
              <p className="font-medium">Site Paris Centre</p>
              <p className="text-sm text-gray-600">Demain 14h00</p>
            </div>
            <div className="p-3 border-l-4 border-blue-500 bg-blue-50">
              <p className="font-medium">Site Lyon Part-Dieu</p>
              <p className="text-sm text-gray-600">Vendredi 10h00</p>
            </div>
          </div>
        </div>

        <div className="card">
          <h4 className="text-lg font-medium text-gray-900 mb-4">R√©sultats r√©cents</h4>
          <div className="space-y-3">
            <div className="p-3 border-l-4 border-green-500 bg-green-50">
              <p className="font-medium">Site Marseille</p>
              <p className="text-sm text-gray-600">Score: 92% - Excellent</p>
            </div>
            <div className="p-3 border-l-4 border-yellow-500 bg-yellow-50">
              <p className="font-medium">Site Toulouse</p>
              <p className="text-sm text-gray-600">Score: 78% - √Ä am√©liorer</p>
            </div>
          </div>
        </div>

        <div className="card">
          <h4 className="text-lg font-medium text-gray-900 mb-4">Actions requises</h4>
          <div className="space-y-3">
            <div className="p-3 border-l-4 border-red-500 bg-red-50">
              <p className="font-medium">Formation √©quipe</p>
              <p className="text-sm text-gray-600">Site Bordeaux</p>
            </div>
            <div className="p-3 border-l-4 border-orange-500 bg-orange-50">
              <p className="font-medium">Mise √† jour proc√©dures</p>
              <p className="text-sm text-gray-600">3 sites concern√©s</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  );
};




export default ChainManagement;